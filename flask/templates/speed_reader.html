<!DOCTYPE html>
<html>
<head>
    <!-- <link rel="stylesheet" href="{{ url_for('static', filename='main.css') }}"> -->
    <style type="text/css">

@font-face {
font-family: fira_code;
font-style: normal;
font-weight: normal;
font-stretch: normal;
src: url('../static/Fira_Code/FiraCode-VariableFont:wght.ttf') format('woff');
}
body {
    font-family: fira_code, monospace;
    font-size: 2.5vw;
    margin:0px;
    color:white;
    background-color: black;
}
.middle {color:red;}
.begin {width:40vw; text-align: right}
.word {
    width:100%;
    display: flex;
    border-spacing:0;
    border:none;
    position: absolute;
    bottom: 5vw;
}
.word > tbody {
    width:100%;
    font-size: 10vw;
}

.debug {
    display:none;
}

#wrapper
{
    height:100%;
}

#output{
    position: absolute;
    margin: 0 50px;
    bottom: 22vw;
}

#output>span{
    white-space: pre-wrap;
}
    </style>
    <!-- <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script> -->
    <title></title>
</head>
<body>
    <div id="wrapper">
        <div id="output">
            <span></span>
        </div>
        <table class="word">
        <tr>
            <td class="begin"></td><td class="middle"></td><td class="end"></td>
        </tr>
        </table>
    </div>
    <table class="debug" width="33.3333%" height="50px" style="border-right: solid white; position:absolute;">
    </table>
    <script type="text/javascript">
        var raw_text = "\nThe Attainder taken from Jonathan Butler\n(Reverse) The day the Court were present w'th them. \nBridget Butler and Sarah Good affirmed in open Court that the above n'th Press were not persons, but were  spirits of grace from God: and the afflicted asked whether they were  any way got along with him; but they denied it, their Lord being  with them as a friend or no way got along with them. \nBrought up on a Gospel Question, was it not to yourself why no one hath taken care to notice  who you are a thing contrary to the Peace of our Sovereign Lord and Lady the King and  Queen? I meant myself; in the end I do not know; and am sure there is a God in heaven to find God in every soul -- the afflicted, they can not be found in any  other body to give their opinion of my truth.\nI can give no other opinion of things besides my soul.\nI know it is false to accuse the Press which does all this to set up this evident malice. to the best of my faculties.\nI am as clear as the clear mouther from any other person or spirit  or no spirit. \nIf you will";
        text = raw_text.split(/\s/g);
        var beg = document.getElementsByClassName('begin');
        var mid = document.getElementsByClassName('middle');
        var end = document.getElementsByClassName('end');
        var out = document.getElementById('output');
        var current_idx = 0;
        var speed = 300;
        function nextText(){
            var t = "<<PAUSE>>";
            if(text.length != 0){
                t = text[0];
            }
            if(!t){
                text.shift()
                nextText();
                return
            }
            if(t == "<<PAUSE>>"){
                text.shift()
                return
            }
            var split = 4;
            if(t.length < 2) {
                split = 0;
            } else if(t.length < 6) {
                split = 1;
            }
            else if(t.length < 10) {
                split = 2;
            }
            else if(t.length < 14) {
                split = 3;
            }

            beg[0].textContent = t.slice(0        , split)
            mid[0].textContent = t.slice(split    , split + 1)
            end[0].textContent = t.slice(split + 1, t.length)
            text.shift()
            current_idx = raw_text.slice(current_idx).search(t) + current_idx
            out.lastChild.textContent=raw_text.slice(0,current_idx) + t
            console.log(current_idx + "/" + raw_text.length)

            if(t.match(/[?,;.!:"]$/g))
            {
                text.unshift("<<PAUSE>>")
                return
            }
        };

        setInterval(nextText, 1000 * 60 / speed);
    </script>
</body>
</html>